<!-- Second Follow-Up page that shows when it is time to follow-up.
	 The follow-up date was set by the provider. This will ask how
	 the patient is feeling with three faces: all better, somewhat
	 better, and no improvement.

	 If "All Better" then will ask for reviews
	 	that will proceed them to Review page to see documents and invoice,

	 Otherwise "Somewhat better" or "No improvement" then will show
	 	another text box informing them their provider was notified and
	 	will call them soon -->

<template name="followupPage2">

	<!-- CSS -->
	<style>
		/* Shows pointer finger when hovered over the faces */
		.ui.images {
	    	cursor: pointer;
	  	}

	  	/* Makes textarea fluid (full width of container) */
		textarea {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;

			width: 100%;
		}
	</style>

	<!-- IF PATIENT IS "SOMEWHAT BETTER" OR FEELS "NO IMPROVEMENT" -->

	<div id="followupSent" class="ui raised text container segment" style="display: none;">
		<center>
		<h3 class="ui header container">
		  <div class="content" id="followupNeededTitle">
			<!-- PROVIDER FIRST NAME has received your feedback
		    	 and will follow-up with you shortly, PATIENT FIRST NAME. -->
		  </div>
		</h3>
		</center>
	</div>

	<!-- END OF PATIENT IS "SOMEWHAT BETTER" OR FEELS "NO IMPROVEMENT" -->

	<!-- PROMPTING PATIENT ABOUT STATUS -->

	<div id="followupContent" class="ui raised text container segment">
		<center>
			<h3 class="ui header container">
			  <div class="content" id="followupTitle">
			    <!-- Please let FIRST NAME OF PROVIDER know how you are feeling
			    	 by selecting your current status below -->
			  </div>
			</h3>
		</center>

		<br><br>

		<!-- HEALTH STATUS SMILEY BUTTONS -->
		<div class="ui column centered grid">
			<center>
				<div class="ui images">
					<img id="happy" class="ui circular image" height="100" width="100" src="/images/happy-face.png">
					<img id="straight" class="ui circular image" height="100" width="100" src="/images/straight-face.png">
					<img id="unhappy" class="ui circular image" height="100" width="100" src="/images/unhappy-face.png">
				</div>
			</center>
		</div>

		<h2 class="ui centered header" id="health-status">
			<!-- Health status clicked on -->
		</h2>

		<br>

		<form class="ui form">
			<center>
			<div class="field inline">
				<label>Comments: </label>
				<textarea rows="2" name="comments" style="width: 300px;"></textarea>
			</div>
			</center>
		</form>

		<br>

		<button id="submit-btn" class="ui primary fluid button" style='visibility:hidden'> 
			Submit Status
		</button>

		<div class="ui positive message hidden" id="success">
		  <div class="header">
		  	Feedback was sent successfully!
		  </div>
		</div>
	</div>

	<!-- END OF PROMPTING PATIENT ABOUT STATUS -->

	<!-- IF PATIENT IS "ALL BETTER" -->

	<div id="happyDiv" class="ui raised text container segment" style="display: none;">
		<center>
			<div id="share-content" style="display: none;">

				<h2 class="ui header">
					<div class="content" id="thankYouText">
						<!-- Thank you for your feedback, PATIENT NAME! -->
					</div>
				</h2>

				<div id="feedbackSubmitted" class="ui text segment">
					<center>
						<div class="ui segment">
							<h3 id="follow-us" class="header">Follow us:</h3>
							<a href="https://www.instagram.com/doctorstoyou/"><i class="instagram square icon huge" style="color:#00bde8;"></i></a>
						  	<a href="https://twitter.com/DoctorsToYou"><i class="twitter square icon huge" style="color:#00bde8;"></i></a>
						  	<a href="https://www.facebook.com/pg/DoctorsToYou/"><i class="facebook square icon huge" style="color:#00bde8;"></i></a>
						</div>
					</center>
				</div>

				<h3 id="click-here-text" class="ui header">
					To review your medical report and invoice:
				</h3>

				<button id="click-here-btn" class="ui big primary button">
					Click Here!
				</button>
			</div>

			<h3 class="ui header container" id="happyStatus">
				<!-- We are so glad to hear you are all better now, PATIENT FIRST NAME!
					 In order to conclude your care, please submit your feedback. We value your opinion and love to hear from our patients! -->
			</h3>

			<br>

			<div id="feedbackContent">
				<h2 class="header">Feedback</h2>

				<table class="ui celled unstackable blue table attached segment">
				  <thead>
				    <tr>
				    	<th class="nine wide"><h3 class="header">Category</h3></th>
				    	<th class="seven wide"><h3 class="header">Rating</h3></th>
				  	</tr>
				  </thead>
				  <tbody>
				    <tr>
				      <td>
				      	<h4 class="header">Punctual</h4>
				      	<div class="sub header">Was your provider on time? Were the time estimates accurate?</div>
				      </td>
				      <td><div class="ui massive star rating" data-rating="5" data-max-rating="5"></div></td>
				    </tr>
				    <tr>
				      <td>
				      	<h4 class="header">Professional</h4>
				      	<div class="sub header">Was your provider professional?</div>
				      </td>
				      <td><div class="ui massive star rating" data-rating="5" data-max-rating="5"></div></td>
				    </tr>
				    <tr>
				      <td>
				      	<h4 class="header">Courteous</h4>
				      	<div class="sub header">Was your provider polite throughout your care?</div>
				      </td>
				      <td><div class="ui massive star rating" data-rating="5" data-max-rating="5"></div></td>
				    </tr>
				    <tr>
				      <td>
				      	<h4 class="header">Caring</h4>
				      	<div class="sub header">Was your provider gentle? Did they listen to your concerns?</div>
				      </td>
				      <td><div class="ui massive star rating" data-rating="5" data-max-rating="5"></div></td>
				    </tr>
				    <tr>
				      <td>
				      	<h4 class="header">Follow-Up</h4>
				      	<div class="sub header">Did you receive quality follow-up care? Did you feel cared for?</div>
				      </td>
				      <td><div class="ui massive star rating" data-rating="5" data-max-rating="5"></div></td>
				    </tr>
				    <tr>
				      <td>
				      	<h4 class="header">Additional Comments:</h4>
				      	<div class="sub header">Is there anything else you would like to share with us? How can we improve?</div>
				      </td>
				      <td><textarea rows="2" maxlength="1000" placeholder="Additional comments..."></textarea></td>
				    </tr>
				  </tbody>
				</table>
				<div id="submitBtn" class="ui bottom attached primary button" tabindex="0">Submit Feedback</div>
				<div class="ui positive message hidden" id="success">
				  <div class="header">
				  	Feedback was sent successfully!
				  </div>
				</div>
			</div>
		</center>
	</div>

	<!-- END OF "ALL BETTER" -->


	<!-- JavaSript -->
	<script type="text/javascript">
		var providerFirstName = "Ernest";
		var patientFirstName = "Pauline"

		var followupTitle = "Please let " + providerFirstName + " know how you are feeling by selecting your current status below:";

		document.getElementById("followupTitle").innerHTML = followupTitle;

		var followupNeededTitleText = providerFirstName + " has received your feedback and will follow-up with you shortly, " + patientFirstName + ".";

		document.getElementById("followupNeededTitle").innerHTML = followupNeededTitleText;

		var happyText = "We are so glad to hear you are all better now, " + patientFirstName + "!<br>In order to conclude your care, please submit your feedback. We value your opinion and love to hear from our patients!";

		document.getElementById("happyStatus").innerHTML = happyText;

		var thankYouText = "Thank you for your feedback, " + patientFirstName + "!";
		document.getElementById("thankYouText").innerHTML = thankYouText;

		var status;

		$(document).ready(function(){

			// Click on happy face
			$("#happy").click(function(){
				$("#happy").css("opacity", "1.0");	//Full opacity for happy
				$("#straight").css("opacity", "0.5");	//Half opacity for straight
				$("#unhappy").css("opacity", "0.5");	//Half opacity for unhappy
				status = "happy";
				document.getElementById("health-status").innerHTML = "I feel all better.";
			});

			// Click on straight face
			$("#straight").click(function(){
				$("#straight").css("opacity", "1.0");	//Full opacity for straight
				$("#happy").css("opacity", "0.5");		//Half opacity for happy
				$("#unhappy").css("opacity", "0.5");	//Half opacity for unhappy
				status = "straight";
				document.getElementById("health-status").innerHTML = "I feel somewhat better.";
			});

			// Click on unhappy face
			$("#unhappy").click(function(){
				$("#unhappy").css("opacity", "1.0");	//Full opacity for unhappy
				$("#straight").css("opacity", "0.5");	//Half opacity for straight
				$("#happy").css("opacity", "0.5");		//Half opacity for happy
				status = "unhappy";
				document.getElementById("health-status").innerHTML = "I feel no improvement.";
			});

			// Click on any of the faces will reveal the submit button
			$("#happy, #straight, #unhappy").click(function(){
				$("#submit-btn").css("visibility", "visible");
			});

			// Click on submit button will trigger respective message
			$("#submit-btn").click(function(){
				event.preventDefault();	//Prevents page from refreshing

				// Disable ability to touch any faces after submitting
				$("#happy, #straight, #unhappy").off("click");
				document.getElementById("submit-btn").disabled = true;
				$('#success').show(500);	// Reveals success message for 500 milliseconds
				$("#success").delay(500).fadeOut(1000);	// Hides success message after 500 milliseconds and then another 1000 milliseconds

				// If "Somewhat better" or "No improvement" will show short message
				// Otherwise "All better" will show ratings box (Not yet implemented)
				if (status == "straight" || status == "unhappy") {
					$("#followupSent").delay(2000).show(500);
				} else {
					$("#followupContent").delay(3000).fadeOut(500);
					$("#happyDiv").delay(3500).show(500);
				}	
			});

			// Click on submit button
			$("#submitBtn").click(function(){
				event.preventDefault();	// Prevent page from refreshing
				$('#success').show(500);	// Reveal in 500 milliseconds
				$("#feedbackContent").delay(400).fadeOut(1000);
				$("#feedbackSubmitted").delay(500).show(500);
				$('#share-content').delay(500).show(100);
				$('#happyStatus').hide();
				Meteor.call('updateStatus', Meteor.userId());
			});

			$("#click-here-btn").click(function(){
				Meteor.call('updateView', Meteor.userId(), 'Review');
			});
		});

		// Rating functionality
		$('.rating').rating();
	</script>
</template>
