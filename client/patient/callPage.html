<!-- Call page. Second menu on the patient dashboard. 
	After a patient requests on the Request page, they will see this page -->

<template name="callPage">

	<!-- CSS -->
	<style>
		/* Shows pointer finger when hovered over dashboard menu */
		.ui.pointing.menu {
			cursor: pointer;
		}
		
		/* Makes textarea fluid */
		textarea {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;

			width: 100%;
	  	}
	</style>

	<!-- Informative box about how long call wait will be -->
	<center>
		<div class="ui raised very padded text container segment">
			<h1 class="ui header container">
			  <div class="content">
			    Please standby for your call...
			  </div>
			</h1>

			<h2 class="ui header container">
			  <div class="content" id="callText">
			  	<!-- Call text goes here! -->
			  </div>
			</h2>

			<br>

			<button class="cancelBtn negative ui button">Cancel Request</button>
		</div>
	</center>

	<!-- Cancel modal -->
	<div class="ui small modal" id="reasonModal">
	  <i class="close icon"></i>
	  <div class="header">
	    Reason for Cancellation
	  </div>

	  <div class="content">
	  	<select id="multi-select" name="reasonForCancellation" multiple="" class="ui fluid dropdown required">
		  <option value="">Select all that apply:</option>
			<option value="feelbetter">I feel better</option>
			<option value="longWait">Long wait time</option>
		</select>

		<br>

	  	<div class="inline"><label>Other: </label><textarea rows="1"></textarea></div>
	  </div>

	  <div class="actions" id="cancelReq">
	    <button class="ui fluid negative deny button">
	      Confirm Cancellation
	    </button>
	  </div>
	</div>

	<!-- After cancelled request, will open this confirmation modal -->
	<div class="ui cancelled-redirect small modal">
		<i class="close icon"></i>
    	<div class="header">
    		You have cancelled your request.
  		</div>

  		<div class="content">
  			<center><h3>We will now redirect you to your dashboard.</h3></center>
  		</div>

  		<!-- Redirect button to dashboard -->
  		<div class="actions" id="returnDashboard">
			<button class="ui fluid primary button">
		    	Return to Dashboard
		    </button>
		</div>

	</div>

	<!-- JavaScript -->
	<script type="text/javascript">
		var providerName = "Ernest";
		var timeEstimate = 15;

		var callText = providerName + " will call you in approximately " + timeEstimate + " minutes. <br> Thank you for choosing Doctors To You!";

		document.getElementById("callText").innerHTML = callText;


		$(document).ready(function(){

			// Click to open cancel request button
			$(".cancelBtn").click(function(){
				$('#reasonModal').modal({
					autofocus: false, //Prevents the dropdown from dropping automatically
				}).modal('show');	
			});

			// Click to cancel request button
			$("#cancelReq").click(function(){
				$('#reasonModal').modal('hide');
				$('.cancelled-redirect').modal({
					autofocus: false, //Prevents the dropdown from dropping automatically
				}).modal('show');
				
			});

			// Click to return to dashboard button
			$("#returnDashboard").click(function(){
				$('#returnDashboard').modal('hide');
				FlowRouter.go('/dashboard'); //Redirect to /dashboard URL
			});

		});

		// Allows multiselect dropdown function to work
		$('#multi-select')
		  .dropdown()
		;

	</script>

</template>

<!-- Page we want to show if patient has cancelled. 
	 Possibly just disable Call page if cancelled so this could be obsolete -->
<template name="cancelledRequestCallPage">
	<center>
		<h1 class="ui header container">
		  <div class="content">
		    You have cancelled your request
		  </div>
		</h1>

		<button class="ui large primary button">
	    	Return to Dashboard
	    </button>
	</center>
</template>